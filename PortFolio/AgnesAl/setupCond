//Google Form use duplicate method to add data
  //therefore, it will follow the first column format
  //set format after


function conditionalFormatting() {
  

//Main Sheet Conditional Format
  setCF4mainsheet(
    SpreadsheetApp.getActiveSpreadsheet().getSheets().filter(
        x => /Form responses/i.test(x.getSheetName())
              )[0].getSheetName()
              )  //set conditional formatting on mainsheet


  SpreadsheetApp.getActiveSpreadsheet().getSheets().map( x=>

  {
    if(/\b\w{3}\b/.test(x.getSheetName())){


    //Set Conditonal Format

    x.setConditionalFormatRules(
        [
          SpreadsheetApp.newConditionalFormatRule()
        .setRanges([ x.getRange(...[2,hIdxS('Full Name',msheader(x.getSheetName())),x.getMaxRows()-1,1])])
        .whenFormulaSatisfied(`= countif(${duplicateEmail})>1`)
        .setBackground('#00FFFF')
        .build()
        ]
     ); //End conditional Format


    //Format cell
    x.getRange('1:1').setFontWeight('bold').setFontColor('#85200c').setHorizontalAlignment('center');

    x.getRange(...[ 1, 1, 1, msheader(x.getSheetName()).filter( x=> typeof x !== 'object').filter( x => x!=='').length]
).setFontColor('#000000');

    x.getRange(...[2,1,x.getMaxRows()-1,msheader(x.getSheetName()).filter( x=> typeof x !== 'object').filter( x => x!=='').length]).setWrapStrategy(SpreadsheetApp.WrapStrategy.CLIP); 

    x.getRange(...[2,hIdxS('Comment',msheader(x.getSheetName())),x.getMaxRows()-1,1]).setWrapStrategy(SpreadsheetApp.WrapStrategy.WRAP);


  x.setFrozenRows(1);
        //End format cell






    };
  }
    
  



  )

      

}
